<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Booking Summary</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
</head>

<body class="bg-gray-100 font-[Inter] min-h-screen flex items-center justify-center">

  <div class="bg-white w-full max-w-lg rounded-xl shadow-lg p-8">

    <h1 class="text-2xl font-semibold text-blue-800 mb-2">
      Review Booking
    </h1>

    <p class="text-sm text-gray-500 mb-6">
      Please confirm your booking details
    </p>

    <div class="border rounded-lg p-5 space-y-4 text-sm text-gray-700">

      <div class="flex justify-between">
        <span class="text-gray-500">Amount</span>
        <span id="amount"></span>
      </div>

      <div class="flex justify-between">
        <span class="text-gray-500">Date</span>
        <span id="date"></span>
      </div>

      <div class="flex justify-between">
        <span class="text-gray-500">Time Slot</span>
        <span id="slot"></span>
      </div>

      <div class="flex justify-between">
        <span class="text-gray-500">Vehicle</span>
        <span>Auto Assigned</span>
      </div>

    </div>

    <div class="mt-8 flex gap-4">
      <button
        onclick="history.back()"
        class="w-1/2 border border-gray-300 py-3 rounded-lg">
        Back
      </button>

      <button
        id="confirmBtn"
        class="w-1/2 bg-indigo-600 text-white py-3 rounded-lg font-medium hover:bg-indigo-700">
        Confirm Booking
      </button>
    </div>

  </div>

  <!-- API helper -->
  <script src="js/api.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      document.getElementById("amount").innerText =
        "â‚¹" + localStorage.getItem("amount");
      document.getElementById("date").innerText =
        localStorage.getItem("date");
      document.getElementById("slot").innerText =
        localStorage.getItem("slot");
    });

    document.getElementById("confirmBtn").addEventListener("click", async () => {
      try {
        const amount = Number(localStorage.getItem("amount"));

        // ðŸ”¥ REAL BACKEND CALL
        const res = await api("/dealer/book", {
          method: "POST",
          body: JSON.stringify({
            date: localStorage.getItem("date"),
            slot: localStorage.getItem("slot"),
            amount: Number(localStorage.getItem("amount"))
          })
        });

        // optional handling
        if (res.status === "WAITING") {
          alert("Your order is added to waiting list");
        }

        window.location.href = "success.html";
      } catch (e) {
        alert(e.message || "Booking failed");
      }
    });
  </script>

</body>
</html>
